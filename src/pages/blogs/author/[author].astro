---
export const prerender = false;
import MainLayout from "../../../layouts/MainLayout.astro";

interface Author {
  name: string;
  slug: string;
  post:{
    title: string;
    slug: string;
  }[]
}

const { author } = Astro.params;

const query = {
  method: "POST",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify({
    query: `
      {
        authors {
          name
          slug
          post{
            title
            slug
          }
        }
      }
    `,
  }),
};

const response = await fetch(import.meta.env.HYGRAPH_API, query);
const json = await response.json();
const op: Author | undefined = json?.data?.authors?.find((p: Author) => p.slug === author);
---

<MainLayout>
  <div class="w-full lg:max-w-4xl mx-auto">
    <div class="p-5 grid sm:grid-cols-2 gap-5">
      {op?.post.map(({title, slug}) => (
          <a href={`/blogs/${slug}`} class="p-5 border rounded-[20px]">
              <h2>{title}</h2>
          </a>
      ))}
    </div>
  </div>
</MainLayout>